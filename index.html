<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üü© Quadrilateral Area Game</title>
<style>
  body {
    font-family: 'Comic Sans MS', cursive, sans-serif;
    margin: 0; padding: 0;
    background: linear-gradient(135deg, #84fab0, #8fd3f4);
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh;
  }
  h1 { margin-top: 20px; color: #fff; text-shadow: 2px 2px 5px #00897b; }
  .tabs { margin-top: 15px; }
  .tab-btn {
    padding: 10px 20px; margin: 3px;
    font-size: 16px; border: none;
    border-radius: 10px; cursor: pointer;
    background: #4db6ac; color: white; font-weight: bold;
  }
  .tab-btn.active { background: #00897b; box-shadow: 0 0 10px rgba(0,0,0,0.3); }
  .game-card {
    background: rgba(255,255,255,0.95);
    padding: 30px; border-radius: 20px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
    text-align: center; margin-top: 20px;
    position: relative; overflow: hidden;
  }
  canvas { margin: 20px 0; border-radius: 15px; border: 2px solid #00897b; background: #fff; }
  input[type="text"] {
    padding: 12px; font-size: 18px; width: 220px;
    border-radius: 10px; border: 2px solid #00897b;
    outline: none; text-align: center;
  }
  button {
    padding: 12px 25px; margin: 10px; font-size: 18px;
    border: none; border-radius: 15px; cursor: pointer;
    background: #00897b; color: white; font-weight: bold;
    transition: 0.3s;
  }
  button:hover { background: #4db6ac; }
  .feedback { font-size: 22px; font-weight: bold; margin-top: 15px; min-height: 30px; }
  .progress { font-size: 18px; color: #444; margin-top: 10px; }
  .firework {
    position: absolute; width: 8px; height: 8px; border-radius: 50%;
    pointer-events: none; animation: explode 1.2s forwards;
  }
  @keyframes explode {
    0% {transform: scale(1); opacity: 1;}
    70% {transform: scale(2.5); opacity: 0.9;}
    100% {transform: scale(4); opacity: 0;}
  }
</style>
</head>
<body>

<h1>üü© Quadrilateral Area Game</h1>

<div class="tabs">
  <button class="tab-btn active" onclick="switchMode('all', event)">All</button>
  <button class="tab-btn" onclick="switchMode('rectangle', event)">Rectangle</button>
  <button class="tab-btn" onclick="switchMode('square', event)">Square</button>
  <button class="tab-btn" onclick="switchMode('parallelogram', event)">Parallelogram</button>
  <button class="tab-btn" onclick="switchMode('rhombus', event)">Rhombus</button>
  <button class="tab-btn" onclick="switchMode('kite', event)">Kite</button>
  <button class="tab-btn" onclick="switchMode('trapezium', event)">Trapezium</button>
  <button class="tab-btn" onclick="restartGame()">Restart üîÑ</button>
</div>

<div class="game-card">
  <div class="progress" id="progress"></div>
  <canvas id="shapeCanvas" width="400" height="300"></canvas>
  <div>
    <label for="answer">Enter area: </label>
    <input type="text" id="answer" placeholder="e.g. 24 or base*height">
  </div>
  <div>
    <button onclick="checkAnswer()">Submit ‚úÖ</button>
  </div>
  <div id="feedback" class="feedback"></div>
</div>

<audio id="applause" src="https://www.soundjay.com/human/applause-8.mp3"></audio>

<script>
const shapes = {
  rectangle: Array.from({length:10},()=>({w:rand(4,12), h:rand(4,10)})),
  square: Array.from({length:10},()=>({a:rand(4,12)})),
  parallelogram: Array.from({length:10},()=>({b:rand(5,12), h:rand(4,10)})),
  rhombus: Array.from({length:10},()=>({d1:rand(5,12), d2:rand(4,10)})),
  kite: Array.from({length:10},()=>({d1:rand(5,12), d2:rand(4,10)})),
  trapezium: Array.from({length:10},()=>({a:rand(4,10), b:rand(5,12), h:rand(4,8)}))
};

function rand(min,max){return Math.floor(Math.random()*(max-min+1))+min;}

let mode='all', filtered=[], currentIndex=0;

function switchMode(selected, ev){
  mode=selected;
  document.querySelectorAll('.tab-btn').forEach(btn=>btn.classList.remove('active'));
  ev.target.classList.add('active');
  filtered=(mode==='all')?Object.values(shapes).flat():shapes[mode];
  shuffle(filtered);
  currentIndex=0;
  loadShape();
}

function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
}

function drawShape(shape, type){
  const ctx=document.getElementById("shapeCanvas").getContext("2d");
  ctx.clearRect(0,0,400,300);
  ctx.strokeStyle="#333"; ctx.lineWidth=2; ctx.font="16px Arial"; ctx.fillStyle="#000";

  if(type==="rectangle"){
    ctx.strokeRect(100,100,shape.w*15,shape.h*15);
    ctx.fillText(`w=${shape.w}`,150,95);

    // height dotted line
    ctx.setLineDash([5,5]);
    ctx.beginPath();
    ctx.moveTo(100,100);
    ctx.lineTo(100,100+shape.h*15);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillText(`h=${shape.h}`,80,100+shape.h*7.5);
  }

  else if(type==="square"){
    ctx.strokeRect(120,100,shape.a*15,shape.a*15);
    ctx.fillText(`a=${shape.a}`,120+shape.a*7,95);

    // height dotted line
    ctx.setLineDash([5,5]);
    ctx.beginPath();
    ctx.moveTo(120,100);
    ctx.lineTo(120,100+shape.a*15);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillText(`h=${shape.a}`,100,100+shape.a*7.5);
  }

  else if(type==="parallelogram"){
    ctx.beginPath();
    ctx.moveTo(100,200);
    ctx.lineTo(100+shape.b*15,200);
    ctx.lineTo(100+shape.b*15-40,200-shape.h*15);
    ctx.lineTo(60,200-shape.h*15);
    ctx.closePath(); ctx.stroke();
    ctx.fillText(`b=${shape.b}`,140,215);

    // height dotted line
    ctx.setLineDash([5,5]);
    ctx.beginPath();
    ctx.moveTo(60,200-shape.h*15);
    ctx.lineTo(60,200);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillText(`h=${shape.h}`,65,200-shape.h*7);
  }

  else if(type==="rhombus" || type==="kite"){
    ctx.beginPath();
    ctx.moveTo(200,150-shape.d2*7.5);
    ctx.lineTo(200+shape.d1*7.5,150);
    ctx.lineTo(200,150+shape.d2*7.5);
    ctx.lineTo(200-shape.d1*7.5,150);
    ctx.closePath(); ctx.stroke();
    ctx.fillText(`d1=${shape.d1}`,200+5,145);
    ctx.fillText(`d2=${shape.d2}`,205,150-shape.d2*4);

    // vertical height line (d2)
    ctx.setLineDash([5,5]);
    ctx.beginPath();
    ctx.moveTo(200,150-shape.d2*7.5);
    ctx.lineTo(200,150+shape.d2*7.5);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillText(`h=${shape.d2}`,210,150);
  }

  else if(type==="trapezium"){
    ctx.beginPath();
    ctx.moveTo(100,200);
    ctx.lineTo(100+shape.b*15,200);
    ctx.lineTo(100+shape.a*15+20,200-shape.h*15);
    ctx.lineTo(80,200-shape.h*15);
    ctx.closePath(); ctx.stroke();
    ctx.fillText(`a=${shape.a}`,110,200-shape.h*15-5);
    ctx.fillText(`b=${shape.b}`,140,215);

    // height dotted line
    ctx.setLineDash([5,5]);
    ctx.beginPath();
    ctx.moveTo(100,200);
    ctx.lineTo(100,200-shape.h*15);
    ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillText(`h=${shape.h}`,80,200-shape.h*7);
  }
}

function loadShape(){
  const shape=filtered[currentIndex];
  drawShape(shape, mode==="all"?detectType(shape):mode);
  document.getElementById('answer').value='';
  document.getElementById('feedback').textContent='';
  document.getElementById('progress').textContent=`Question ${currentIndex+1} of ${filtered.length}`;
}

function detectType(shape){
  for(const t in shapes){ if(shapes[t].includes(shape)) return t; }
  return "rectangle";
}

function calcArea(shape,type){
  switch(type){
    case "rectangle": return shape.w*shape.h;
    case "square": return shape.a*shape.a;
    case "parallelogram": return shape.b*shape.h;
    case "rhombus": return (shape.d1*shape.d2)/2;
    case "kite": return (shape.d1*shape.d2)/2;
    case "trapezium": return (shape.a+shape.b)/2*shape.h;
  }
}

function checkAnswer(){
  const shape=filtered[currentIndex];
  const type=mode==="all"?detectType(shape):mode;
  const userInput=document.getElementById('answer').value.trim();
  const feedback=document.getElementById('feedback');
  const correctValue=calcArea(shape,type);

  let userValue;
  try{ userValue=eval(userInput);}catch{ userValue=NaN;}

  if(Math.abs(userValue-correctValue)<0.1){
    feedback.textContent='üéâ Correct!';
    feedback.style.color='green';
    showFireworks();
    document.getElementById("applause").play();
    setTimeout(()=>{
      currentIndex++;
      if(currentIndex>=filtered.length){
        feedback.textContent='üèÜ Well done! You finished this set!';
        shuffle(filtered); currentIndex=0;
        setTimeout(loadShape,2000);
      } else loadShape();
    },1500);
  } else {
    feedback.textContent='‚ùå Try again!';
    feedback.style.color='red';
  }
}

function restartGame(){ shuffle(filtered); currentIndex=0; loadShape(); }

function showFireworks(){
  for(let i=0;i<15;i++){
    const fw=document.createElement('div');
    fw.className='firework';
    fw.style.left=(100+Math.random()*200)+'px';
    fw.style.top=(50+Math.random()*150)+'px';
    fw.style.background=`hsl(${Math.random()*360},100%,50%)`;
    document.querySelector('.game-card').appendChild(fw);
    setTimeout(()=>fw.remove(),1200);
  }
}

// Enable Enter key
document.getElementById("answer").addEventListener("keypress", function(e){
  if(e.key === "Enter"){ checkAnswer(); }
});

// init
switchMode('all',{target:document.querySelector('.tab-btn')});
</script>
</body>
</html>
